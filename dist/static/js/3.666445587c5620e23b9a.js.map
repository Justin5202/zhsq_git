{"version":3,"sources":["webpack:///static/js/3.666445587c5620e23b9a.js","webpack:///./src/util/map.js","webpack:///./src/settings/textSearch.js","webpack:///./src/components/content/textSearch.vue","webpack:///src/components/content/textSearch.vue","webpack:///./src/components/content/textSearch.vue?639a","webpack:///./src/components/content/textSearch.vue?4dce","webpack:///./src/components/content/textSearch.vue?6658"],"names":["webpackJsonp","276G","module","__webpack_exports__","__webpack_require__","getPoint","data","pointLike","key","hasOwnProperty","element","length","arr","Lo+p","queryConfig","val","Name_CHN","injectStyle","ssrContext","Object","defineProperty","value","helpers_extends","extends_default","n","search","config","selectionConfig","id","type","paint","circle-color","searchConfig","map","textSearch","name","props","client","index","layer","input","created","this","initLayer","initMarker","methods","source","addGeoLayer","el","document","createElement","className","style","fontSize","color","marker","window","d2c","Marker","handleRowClick","row","event","column","point","_source","geometry","coordinates","flyTo","center","zoom","handleInput","updateLayer","geojsons","item","setGeojson","features","updateMarker","setLngLat","addTo","_this","searchFullText","query","res","arguments","undefined","hits","error","console","log","removeLayer","removeGeoLayer","removeMarker","remove","destroye","beforeDestroy","render","_vm","_h","$createElement","_c","_self","attrs","placeholder","on","change","model","callback","$$v","expression","_v","directives","rawName","_s","staticStyle","width","stripe","row-click","label","show-overflow-tooltip","scopedSlots","_u","fn","scope","trim","Address","staticRenderFns","esExports","content_textSearch","normalizeComponent","__vue_styles__","Component","WmW3","exports","push","i","version","sources","names","mappings","file","sourcesContent","sourceRoot","ayQT","content","locals"],"mappings":"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","file":"static/js/3.666445587c5620e23b9a.js","sourcesContent":["webpackJsonp([3],{\n\n/***/ \"276G\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (immutable) */ __webpack_exports__[\"a\"] = getPoint;\n/**\n * @description get point from data\n */\nfunction getPoint(data) {\n  if (pointLike(data)) {\n    return data;\n  }\n  for (var key in data) {\n    if (data.hasOwnProperty(key)) {\n      var element = data[key];\n      if (pointLike(element)) {\n        return element;\n      } else {\n        return element.length && getPoint(element);\n      }\n    }\n  }\n  return [];\n}\n\nfunction pointLike(arr) {\n  return arr.length && arr.length === 2 && !arr[0].length;\n}\n\n/***/ }),\n\n/***/ \"Lo+p\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n\n// EXTERNAL MODULE: ./node_modules/babel-runtime/helpers/extends.js\nvar helpers_extends = __webpack_require__(\"Dd8w\");\nvar extends_default = /*#__PURE__*/__webpack_require__.n(helpers_extends);\n\n// EXTERNAL MODULE: ./src/settings/search.js\nvar search = __webpack_require__(\"f97g\");\n\n// CONCATENATED MODULE: ./src/settings/textSearch.js\n\n/*\r\n * @Description: 全文搜索\r\n * @Author: xia\r\n * @Date: 2017-12-11 15:01:35\r\n * @Last Modified by: xia\r\n * @Last Modified time: 2017-12-15 12:38:58\r\n */\n\n\n/**\r\n * @description 全文查询配置 默认使用search.js配置\r\n * @param index 索引\r\n * @param client es\r\n * @param ...\r\n */\nvar config = {};\n\n/**\r\n * @description 搜索中间件配置\r\n */\nfunction queryConfig(val) {\n  return {\n    Name_CHN: val || ''\n  };\n};\n\nvar selectionConfig = {\n  id: 'textSearch',\n  type: 'circle',\n  paint: {\n    'circle-color': 'red'\n  }\n};\n\nvar searchConfig = extends_default()({}, search, config);\n// EXTERNAL MODULE: ./src/util/map.js\nvar map = __webpack_require__(\"276G\");\n\n// CONCATENATED MODULE: ./node_modules/babel-loader/lib!./node_modules/vue-loader/lib/selector.js?type=script&index=0!./src/components/content/textSearch.vue\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n\n\n/* harmony default export */ var textSearch = ({\n  name: 'textSearch',\n  props: ['map'],\n  data: function data() {\n    return {\n      client: searchConfig.client,\n      index: searchConfig.index,\n      data: null,\n      layer: null,\n      input: '',\n      queryConfig: queryConfig,\n      selectionConfig: selectionConfig,\n      getPoint: map[\"a\" /* getPoint */]\n    };\n  },\n  created: function created() {\n    this.initLayer();\n    this.initMarker();\n  },\n\n  methods: {\n    initLayer: function initLayer() {\n      delete this.selectionConfig.source;\n      this.layer = this.map.addGeoLayer(this.selectionConfig);\n    },\n    initMarker: function initMarker() {\n      this.el = document.createElement('i');\n      this.el.className = 'el-icon-location';\n      this.el.style.fontSize = '24px';\n      this.el.style.color = '#409eff';\n      this.marker = new window.d2c.Marker(this.el);\n    },\n    handleRowClick: function handleRowClick(row, event, column) {\n      var point = this.getPoint(row._source.geometry.coordinates);\n      // this.updateMarker(point)\n      this.map.flyTo({\n        center: point,\n        zoom: 16\n      });\n    },\n    handleInput: function handleInput(val) {\n      this.search(val);\n    },\n    updateLayer: function updateLayer() {\n      var geojsons = this.data.map(function (item) {\n        return {\n          geometry: item._source.geometry,\n          type: 'Feature'\n        };\n      });\n      this.map.setGeojson(this.selectionConfig.id, {\n        type: 'FeatureCollection',\n        features: geojsons\n      });\n    },\n    updateMarker: function updateMarker(point) {\n      this.marker.setLngLat(point).addTo(this.map);\n    },\n    search: function search(val) {\n      var _this = this;\n\n      try {\n        this.client.searchFullText({\n          index: this.index,\n          query: this.queryConfig(val)\n        }, function () {\n          var error = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '> text search';\n          var res = arguments[1];\n\n          if (res.hits.hits.length === 0) {\n            _this.data = '暂无数据';\n          } else {\n            _this.data = res.hits.hits;\n            _this.updateLayer();\n          }\n        });\n      } catch (error) {\n        console.log('> text search:', error);\n      }\n    },\n    removeLayer: function removeLayer() {\n      this.map.removeGeoLayer(this.selectionConfig.id);\n    },\n    removeMarker: function removeMarker() {\n      this.marker && this.marker.remove();\n    },\n    destroye: function destroye() {\n      this.removeLayer();\n      this.removeMarker();\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.destroye();\n  }\n});\n// CONCATENATED MODULE: ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-56d879c2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/content/textSearch.vue\nvar render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"textSearchContainer\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入内容\"},on:{\"change\":_vm.handleInput},model:{value:(_vm.input),callback:function ($$v) {_vm.input=$$v},expression:\"input\"}}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(this.data!==null),expression:\"this.data!==null\"}],attrs:{\"id\":\"textSearch\"}},[(typeof _vm.data === 'string')?_c('p',[_vm._v(_vm._s(this.data))]):_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.data,\"stripe\":\"\"},on:{\"row-click\":_vm.handleRowClick}},[_c('el-table-column',{attrs:{\"type\":\"index\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"名称\",\"width\":\"200\",\"show-overflow-tooltip\":true},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(scope.row._source.Name_CHN && scope.row._source.Name_CHN.trim() || '暂无名称'))]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"地址\",\"width\":\"200\",\"show-overflow-tooltip\":true},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(scope.row._source.Address && scope.row._source.Address.trim() || '暂无地址'))]}}])})],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\n/* harmony default export */ var content_textSearch = (esExports);\n// CONCATENATED MODULE: ./src/components/content/textSearch.vue\nfunction injectStyle (ssrContext) {\n  __webpack_require__(\"ayQT\")\n}\nvar normalizeComponent = __webpack_require__(\"VU/8\")\n/* script */\n\n/* template */\n\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  textSearch,\n  content_textSearch,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\n/* harmony default export */ var components_content_textSearch = __webpack_exports__[\"default\"] = (Component.exports);\n\n\n/***/ }),\n\n/***/ \"WmW3\":\n/***/ (function(module, exports, __webpack_require__) {\n\nexports = module.exports = __webpack_require__(\"FZ+f\")(true);\n// imports\n\n\n// module\nexports.push([module.i, \"\\n#textSearch {\\n  overflow-y: scroll;\\n  max-height: 500px;\\n  line-height: 2em;\\n}\\n#textSearch .el-table .cell.el-tooltip {\\n    cursor: pointer;\\n}\\n#textSearch .el-table th {\\n    text-align: center !important;\\n}\\n#textSearchContainer {\\n  border-radius: 4px 4px 0px 0px;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"C:/Users/Dell/Workplace/d2c_vue/src/components/content/textSearch.vue\"],\"names\":[],\"mappings\":\";AACA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,iBAAiB;CAClB;AACD;IACI,gBAAgB;CACnB;AACD;IACI,8BAA8B;CACjC;AACD;EACE,+BAA+B;CAChC\",\"file\":\"textSearch.vue\",\"sourcesContent\":[\"\\n#textSearch {\\n  overflow-y: scroll;\\n  max-height: 500px;\\n  line-height: 2em;\\n}\\n#textSearch .el-table .cell.el-tooltip {\\n    cursor: pointer;\\n}\\n#textSearch .el-table th {\\n    text-align: center !important;\\n}\\n#textSearchContainer {\\n  border-radius: 4px 4px 0px 0px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n/***/ }),\n\n/***/ \"ayQT\":\n/***/ (function(module, exports, __webpack_require__) {\n\n// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = __webpack_require__(\"WmW3\");\nif(typeof content === 'string') content = [[module.i, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = __webpack_require__(\"rjj0\")(\"69dae3bd\", content, true);\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// static/js/3.666445587c5620e23b9a.js","/**\n * @description get point from data\n */\nexport function getPoint (data) {\n  if (pointLike(data)) {\n    return data\n  }\n  for (const key in data) {\n    if (data.hasOwnProperty(key)) {\n      const element = data[key]\n      if (pointLike(element)) {\n        return element\n      } else {\n        return element.length && getPoint(element)\n      }\n    }\n  }\n  return []\n}\n\nfunction pointLike (arr) {\n  return arr.length && arr.length === 2 && !arr[0].length\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/util/map.js","/*\r\n * @Description: 全文搜索\r\n * @Author: xia\r\n * @Date: 2017-12-11 15:01:35\r\n * @Last Modified by: xia\r\n * @Last Modified time: 2017-12-15 12:38:58\r\n */\r\nimport * as search from './search'\r\n\r\n/**\r\n * @description 全文查询配置 默认使用search.js配置\r\n * @param index 索引\r\n * @param client es\r\n * @param ...\r\n */\r\nconst config = {}\r\n\r\n/**\r\n * @description 搜索中间件配置\r\n */\r\nexport function queryConfig (val) {\r\n  return {\r\n    Name_CHN: val || ''\r\n  }\r\n};\r\n\r\nexport const selectionConfig = {\r\n  id: 'textSearch',\r\n  type: 'circle',\r\n  paint: {\r\n    'circle-color': 'red'\r\n  }\r\n}\r\n\r\nexport const searchConfig = {\r\n  ...search,\r\n  ...config\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/settings/textSearch.js","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-56d879c2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./textSearch.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./textSearch.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-56d879c2\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":\\\"src\\\",\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./textSearch.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/content/textSearch.vue\n// module id = null\n// module chunks = ","<template>\r\n<div id=\"textSearchContainer\">\r\n  <el-input v-model=\"input\" @change=\"handleInput\" placeholder=\"请输入内容\"></el-input>\r\n  <div id=\"textSearch\" v-show=\"this.data!==null\">\r\n    <p v-if=\"typeof data === 'string'\">{{this.data}}</p>\r\n      <el-table\r\n        v-else\r\n        :data=\"data\"\r\n        stripe\r\n        style=\"width: 100%\"\r\n        @row-click=\"handleRowClick\">\r\n        <el-table-column type=\"index\"></el-table-column>\r\n        <el-table-column label=\"名称\" width=\"200\" :show-overflow-tooltip='true'>\r\n          <template slot-scope=\"scope\">{{ scope.row._source.Name_CHN && scope.row._source.Name_CHN.trim() || '暂无名称' }}</template>\r\n        </el-table-column>\r\n        <el-table-column label=\"地址\" width=\"200\" :show-overflow-tooltip='true'>\r\n          <template slot-scope=\"scope\">{{ scope.row._source.Address && scope.row._source.Address.trim() || '暂无地址' }}</template>\r\n        </el-table-column>\r\n      </el-table>\r\n  </div>\r\n</div>  \r\n</template>\r\n\r\n<script>\r\nimport {queryConfig, searchConfig, selectionConfig} from '@/settings/textSearch'\r\nimport {getPoint} from '@/util/map'\r\nexport default {\r\n  name: 'textSearch',\r\n  props: ['map'],\r\n  data () {\r\n    return {\r\n      client: searchConfig.client,\r\n      index: searchConfig.index,\r\n      data: null,\r\n      layer: null,\r\n      input: '',\r\n      queryConfig,\r\n      selectionConfig,\r\n      getPoint\r\n    }\r\n  },\r\n  created () {\r\n    this.initLayer()\r\n    this.initMarker()\r\n  },\r\n  methods: {\r\n    initLayer () {\r\n      delete this.selectionConfig.source\r\n      this.layer = this.map.addGeoLayer(this.selectionConfig)\r\n    },\r\n    initMarker () {\r\n      this.el = document.createElement('i')\r\n      this.el.className = 'el-icon-location'\r\n      this.el.style.fontSize = '24px'\r\n      this.el.style.color = '#409eff'\r\n      this.marker = new window.d2c.Marker(this.el)\r\n    },\r\n    handleRowClick (row, event, column) {\r\n      const point = this.getPoint(row._source.geometry.coordinates)\r\n      // this.updateMarker(point)\r\n      this.map.flyTo({\r\n        center: point,\r\n        zoom: 16\r\n      })\r\n    },\r\n    handleInput (val) {\r\n      this.search(val)\r\n    },\r\n    updateLayer () {\r\n      const geojsons = this.data.map(item => ({\r\n        geometry: item._source.geometry,\r\n        type: 'Feature'\r\n      }))\r\n      this.map.setGeojson(this.selectionConfig.id, {\r\n        type: 'FeatureCollection',\r\n        features: geojsons\r\n      })\r\n    },\r\n    updateMarker (point) {\r\n      this.marker\r\n      .setLngLat(point)\r\n      .addTo(this.map)\r\n    },\r\n    search (val) {\r\n      try {\r\n        this.client.searchFullText({\r\n          index: this.index,\r\n          query: this.queryConfig(val)\r\n        }, (error = '> text search', res) => {\r\n          if (res.hits.hits.length === 0) {\r\n            this.data = '暂无数据'\r\n          } else {\r\n            this.data = res.hits.hits\r\n            this.updateLayer()\r\n          }\r\n        })\r\n      } catch (error) {\r\n        console.log('> text search:', error)\r\n      }\r\n    },\r\n    removeLayer () {\r\n      this.map.removeGeoLayer(this.selectionConfig.id)\r\n    },\r\n    removeMarker () {\r\n      this.marker && this.marker.remove()\r\n    },\r\n    destroye () {\r\n      this.removeLayer()\r\n      this.removeMarker()\r\n    }\r\n  },\r\n  beforeDestroy () {\r\n    this.destroye()\r\n  }\r\n}\r\n</script>\r\n<style lang=\"scss\">\r\n#textSearch{\r\n  .el-table .cell.el-tooltip{\r\n    cursor: pointer;\r\n  }\r\n  overflow-y: scroll;\r\n  max-height: 500px;\r\n  line-height: 2em;\r\n  .el-table th{\r\n    text-align: center!important\r\n  }\r\n}\r\n\r\n#textSearchContainer{\r\n  border-radius: 4px 4px 0px 0px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/content/textSearch.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"textSearchContainer\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入内容\"},on:{\"change\":_vm.handleInput},model:{value:(_vm.input),callback:function ($$v) {_vm.input=$$v},expression:\"input\"}}),_vm._v(\" \"),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(this.data!==null),expression:\"this.data!==null\"}],attrs:{\"id\":\"textSearch\"}},[(typeof _vm.data === 'string')?_c('p',[_vm._v(_vm._s(this.data))]):_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.data,\"stripe\":\"\"},on:{\"row-click\":_vm.handleRowClick}},[_c('el-table-column',{attrs:{\"type\":\"index\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"名称\",\"width\":\"200\",\"show-overflow-tooltip\":true},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(scope.row._source.Name_CHN && scope.row._source.Name_CHN.trim() || '暂无名称'))]}}])}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"label\":\"地址\",\"width\":\"200\",\"show-overflow-tooltip\":true},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_vm._v(_vm._s(scope.row._source.Address && scope.row._source.Address.trim() || '暂无地址'))]}}])})],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-56d879c2\",\"hasScoped\":false,\"transformToRequire\":{\"video\":\"src\",\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/content/textSearch.vue\n// module id = null\n// module chunks = ","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(true);\n// imports\n\n\n// module\nexports.push([module.id, \"\\n#textSearch {\\n  overflow-y: scroll;\\n  max-height: 500px;\\n  line-height: 2em;\\n}\\n#textSearch .el-table .cell.el-tooltip {\\n    cursor: pointer;\\n}\\n#textSearch .el-table th {\\n    text-align: center !important;\\n}\\n#textSearchContainer {\\n  border-radius: 4px 4px 0px 0px;\\n}\\n\", \"\", {\"version\":3,\"sources\":[\"C:/Users/Dell/Workplace/d2c_vue/src/components/content/textSearch.vue\"],\"names\":[],\"mappings\":\";AACA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,iBAAiB;CAClB;AACD;IACI,gBAAgB;CACnB;AACD;IACI,8BAA8B;CACjC;AACD;EACE,+BAA+B;CAChC\",\"file\":\"textSearch.vue\",\"sourcesContent\":[\"\\n#textSearch {\\n  overflow-y: scroll;\\n  max-height: 500px;\\n  line-height: 2em;\\n}\\n#textSearch .el-table .cell.el-tooltip {\\n    cursor: pointer;\\n}\\n#textSearch .el-table th {\\n    text-align: center !important;\\n}\\n#textSearchContainer {\\n  border-radius: 4px 4px 0px 0px;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-56d879c2\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/content/textSearch.vue\n// module id = WmW3\n// module chunks = 3","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../../node_modules/css-loader/index.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index.js?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-56d879c2\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../node_modules/sass-loader/lib/loader.js?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector.js?type=styles&index=0!./textSearch.vue\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar update = require(\"!../../../node_modules/vue-style-loader/lib/addStylesClient.js\")(\"69dae3bd\", content, true);\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/extract-text-webpack-plugin/dist/loader.js?{\"omit\":1,\"remove\":true}!./node_modules/vue-style-loader!./node_modules/css-loader?{\"sourceMap\":true}!./node_modules/vue-loader/lib/style-compiler?{\"vue\":true,\"id\":\"data-v-56d879c2\",\"scoped\":false,\"hasInlineConfig\":false}!./node_modules/sass-loader/lib/loader.js?{\"sourceMap\":true}!./node_modules/vue-loader/lib/selector.js?type=styles&index=0!./src/components/content/textSearch.vue\n// module id = ayQT\n// module chunks = 3"],"sourceRoot":""}