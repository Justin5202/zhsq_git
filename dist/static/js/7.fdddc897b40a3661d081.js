webpackJsonp([7],{"+dXz":function(e,t,i){"use strict";function n(e){return e.filter(function(e){return e.properties&&e.properties.mapguid})}function r(e){i("PIyL")}Object.defineProperty(t,"__esModule",{value:!0});var s=i("Dd8w"),o=i.n(s),a=i("f97g"),c={query:function(e){return{mapguid:e[0].properties.mapguid}}},l={id:"clickSearch",type:"fill",paint:{"fill-color":"red"}},u=o()({},a,c),h={name:"clickSearch",props:["map"],data:function(){return{selectionConfig:l,queryFilter:n,client:u.client,index:u.index,query:u.query,data:null,selection:null,layer:null}},created:function(){this.init()},methods:{init:function(){this.bindEvent(),this.initLayer()},initLayer:function(){delete this.selectionConfig.source,delete this.selectionConfig["source-layer"],this.layer=this.map.addGeoLayer(this.selectionConfig)},bindEvent:function(){this.map.on("click",this.handleClick)},handleClick:function(e){var t=this.map.queryRenderedFeatures(e.point);if(!t||0===t.length)return void(this.data="暂无数据");this.queryFilter&&(t=this.queryFilter(t)),0!==t.length&&this.search(t)},search:function(e){var t=this;try{this.client.searchProperty({index:this.index,query:this.query(e)},function(){var e=(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments[1]);0===e.hits.hits.length?t.data="暂无数据":(t.data=e.hits.hits[0]._source,t.updateLayer())})}catch(e){console.log(e)}},updateLayer:function(){var e={geometry:this.data.geometry,type:"Feature"};this.map.setGeojson(this.selectionConfig.id,{type:"FeatureCollection",features:[e]})},offEvent:function(){this.map.off("click",this.handleClick)},removeLayer:function(){this.map.removeGeoLayer(this.selectionConfig.id)},destroye:function(){this.offEvent(),this.removeLayer()}},beforeDestroy:function(){this.destroye()}},d=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:null!==this.data,expression:"this.data!==null"}],attrs:{id:"clickSearch"}},["string"==typeof e.data?i("p",[e._v(e._s(this.data))]):e._l(e.data,function(t,n){return i("el-row",{key:n},[i("el-col",{attrs:{span:12}},[i("span",[e._v(e._s(n))])]),e._v(" "),i("el-col",{attrs:{span:12}},[i("span",[e._v(e._s(t))])])],1)})],2)},p=[],f={render:d,staticRenderFns:p},y=f,v=i("VU/8"),m=r,g=v(h,y,!1,m,null,null);t.default=g.exports},AqD2:function(e,t,i){t=e.exports=i("FZ+f")(!0),t.push([e.i,"\n#clickSearch {\n  overflow-y: scroll;\n  max-height: 500px;\n  line-height: 2em;\n  padding: 5px 10px 0px;\n}\n","",{version:3,sources:["C:/Users/Dell/Workplace/d2c_vue/src/components/content/clickSearch.vue"],names:[],mappings:";AACA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,iBAAiB;EACjB,sBAAsB;CACvB",file:"clickSearch.vue",sourcesContent:["\n#clickSearch {\n  overflow-y: scroll;\n  max-height: 500px;\n  line-height: 2em;\n  padding: 5px 10px 0px;\n}\n"],sourceRoot:""}])},PIyL:function(e,t,i){var n=i("AqD2");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);i("rjj0")("5a7d851c",n,!0)}});
//# sourceMappingURL=7.fdddc897b40a3661d081.js.map